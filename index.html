<meta name=viewport content="width=device-width,initial-scale=1,user-scalable=no"><style>canvas{image-rendering:pixelated;left:50%;max-height:100%;max-width:100%;position:fixed;top:50%;transform:translate(-50%,-50%)scale(3,3)}</style><body><script>(()=>{"use strict";const t=["grid"],e=Object.fromEntries(t.map(((t,e)=>[t,e]))),n=new Map;let s=0;class o{x;y;constructor(t,e){this.x=t,this.y=e}add(t){return new o(this.x+t.x,this.y+t.y)}mul(t){return new o(this.x*t,this.y*t)}sub(t){return new o(this.x-t.x,this.y-t.y)}round(){return new o(Math.round(this.x),Math.round(this.y))}equal(t){return Boolean(t&&this.x===t.x&&this.y===t.y)}distance(t){return((this.x-t.x)**2+(this.y-t.y)**2)**.5}empty(){return isNaN(this.x)||isNaN(this.y)}static zero=new o(0,0);static empty=new o(NaN,NaN)}const[i,a]=function(t,e,n=!1){const s=document.createElement("canvas");s.width=t,s.height=e;const o=s.getContext("2d");return o.imageSmoothingEnabled=n,[s,o]}(320,320);i.style.background="#000";let r=o.zero,u=1,d=o.empty,c=o.empty,m=o.empty,l=o.empty,h=!1;function y(t={clientX:NaN,clientY:NaN}){const e=i.getBoundingClientRect();d=new o(320/e.width*(t.clientX-e.left),320/e.height*(t.clientY-e.top)),c=d.sub(new o(160,160)).mul(1/u).add(r)}function f(t){return t.sub(d.sub(new o(160,160)).mul(1/u))}document.title="space-td";let p=0;document.body.append(i),i.addEventListener("mousemove",y),document.addEventListener("mousemove",(t=>{m.empty()||(y(t),!h&&m.distance(d)>5&&(h=!0),h&&(r=f(l),y(t)))})),i.addEventListener("contextmenu",(t=>{t.preventDefault()})),i.addEventListener("wheel",(t=>{u=Math.max(.5,Math.min(1,u-.0625*Math.sign(t.deltaY))),r=f(c)})),i.addEventListener("mouseout",(()=>{h||y()})),i.addEventListener("mousedown",(t=>{t.preventDefault(),y(t),m=d,l=c})),i.addEventListener("mouseup",y),document.addEventListener("mouseup",(()=>{!d.empty()&&(d.x<0||d.y<0||d.x>320||d.y>320)&&y(),m=o.empty,l=o.empty,h=!1})),document.addEventListener("visibilitychange",(()=>{y(),m=o.empty,l=o.empty,h=!1})),s+=1,n.set(1,[e.grid,(t,e,n,s,o)=>{t.beginPath();for(let i=16*Math.floor(e/16);i<s;i+=16)t.moveTo(i,n),t.lineTo(i,o);for(let i=16*Math.floor(n/16);i<o;i+=16)t.moveTo(e,i),t.lineTo(s,i);t.lineWidth=1,t.strokeStyle="#fff",t.stroke(),t.beginPath(),t.fillStyle="#fff",t.arc(0,0,3,0,2*Math.PI),t.fill()}]),function e(s){requestAnimationFrame(e),s>=p+15.666666666666668&&(p=s,a.resetTransform(),a.clearRect(0,0,320,320),a.translate(160,160),a.scale(u,u),a.translate(-r.x,-r.y),function(e,s,o,i,a){const r=t.map((()=>[]));for(const[t,e]of n.values())r[t].push(e);for(const t of r)for(const n of t)n(e,s,o,i,a)}(a,r.x-161/u,r.y-161/u,r.x+161/u,r.y+161/u))}(0);})()</script>
