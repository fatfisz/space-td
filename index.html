<meta name=viewport content="width=device-width,initial-scale=1,user-scalable=no"><style>canvas{left:50%;max-height:100%;max-width:100%;position:fixed;top:50%;transform:translate(-50%,-50%)}</style><body><script>(()=>{"use strict";const t=[];Object.fromEntries(t.map(((t,e)=>[t,e])));const e=new Map;class n{x;y;constructor(t,e){this.x=t,this.y=e}add(t){return new n(this.x+t.x,this.y+t.y)}mul(t){return new n(this.x*t,this.y*t)}sub(t){return new n(this.x-t.x,this.y-t.y)}round(){return new n(Math.round(this.x),Math.round(this.y))}equal(t){return Boolean(t&&this.x===t.x&&this.y===t.y)}distance(t){return((this.x-t.x)**2+(this.y-t.y)**2)**.5}empty(){return isNaN(this.x)||isNaN(this.y)}static zero=new n(0,0);static empty=new n(NaN,NaN)}const[s,i]=function(t,e,n=!1){const s=document.createElement("canvas");s.width=t,s.height=e;const i=s.getContext("2d");return i.imageSmoothingEnabled=n,[s,i]}(1e3,1e3,!0);s.style.background="#000";let o=n.zero,a=1,r=n.empty,u=n.empty,c=n.empty,d=n.empty,m=!1;const h=new n(500,500);function y(t={clientX:NaN,clientY:NaN}){const e=s.getBoundingClientRect();r=new n(1e3/e.width*(t.clientX-e.left),1e3/e.height*(t.clientY-e.top)),u=r.sub(h).mul(1/a).add(o)}function l(t){return t.sub(r.sub(h).mul(1/a))}document.title="space-td";let p=0;document.body.append(s),s.addEventListener("mousemove",y),document.addEventListener("mousemove",(t=>{c.empty()||(y(t),!m&&c.distance(r)>5&&(m=!0),m&&(o=l(d),y(t)))})),s.addEventListener("contextmenu",(t=>{t.preventDefault()})),s.addEventListener("wheel",(t=>{a=Math.max(.5,Math.min(1,a-.0625*Math.sign(t.deltaY))),o=l(u)})),s.addEventListener("mouseout",(()=>{m||y()})),s.addEventListener("mousedown",(t=>{t.preventDefault(),y(t),c=r,d=u})),s.addEventListener("mouseup",y),document.addEventListener("mouseup",(()=>{!r.empty()&&(r.x<0||r.y<0||r.x>1e3||r.y>1e3)&&y(),c=n.empty,d=n.empty,m=!1})),document.addEventListener("visibilitychange",(()=>{y(),c=n.empty,d=n.empty,m=!1})),function n(s){requestAnimationFrame(n),s>=p+15.666666666666668&&(p=s,i.resetTransform(),i.clearRect(0,0,1e3,1e3),i.translate(500,500),i.scale(a,a),i.translate(-o.x,-o.y),function(n){const s=t.map((()=>[]));for(const[t,n]of e.values())s[t].push(n);for(const t of s)for(const e of t)e(n)}(i))}(0);})()</script>
